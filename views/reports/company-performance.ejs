<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <style>
    @media print {
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .no-print { display: none !important; }
      .page-break { page-break-after: always; }
    }
    
    body {
      font-family: 'Noto Sans KR', sans-serif;
      background: #f5f7fa;
      padding: 20px;
    }
    
    .report-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 40px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .report-header {
      text-align: center;
      padding-bottom: 30px;
      border-bottom: 3px solid #3498db;
      margin-bottom: 40px;
    }
    
    .report-title {
      font-size: 32px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 10px;
    }
    
    .report-subtitle {
      font-size: 18px;
      color: #7f8c8d;
    }
    
    .section {
      margin-bottom: 40px;
    }
    
    .section-title {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #ecf0f1;
    }
    
    .section-subtitle {
      font-size: 18px;
      font-weight: bold;
      color: #34495e;
      margin: 20px 0 15px 0;
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .info-card {
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #3498db;
    }
    
    .info-label {
      font-size: 14px;
      color: #7f8c8d;
      margin-bottom: 5px;
    }
    
    .info-value {
      font-size: 20px;
      font-weight: bold;
      color: #2c3e50;
    }
    
    .overview-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .overview-card {
      padding: 20px;
      border-radius: 8px;
      color: white;
      text-align: center;
    }
    
    .overview-card.blue { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .overview-card.green { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .overview-card.orange { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .overview-card.purple { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    
    .overview-card .label {
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 10px;
    }
    
    .overview-card .value {
      font-size: 28px;
      font-weight: bold;
    }
    
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    
    .data-table th {
      background: #3498db;
      color: white;
      padding: 12px;
      text-align: left;
      font-weight: 600;
    }
    
    .data-table td {
      padding: 12px;
      border-bottom: 1px solid #ecf0f1;
    }
    
    .data-table tr:hover {
      background: #f8f9fa;
    }
    
    .text-right {
      text-align: right;
    }
    
    .badge {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .badge.excellent {
      background: #ffd700;
      color: #333;
    }
    
    .badge.grade-s {
      background: #ff6b6b;
      color: white;
    }
    
    .badge.grade-a {
      background: #4ecdc4;
      color: white;
    }
    
    .badge.grade-b {
      background: #45b7d1;
      color: white;
    }
    
    .badge.grade-c {
      background: #95a5a6;
      color: white;
    }
    
    .chart-container {
      margin: 20px 0;
      padding: 20px;
      background: white;
      border-radius: 8px;
    }
    
    .chart-wrapper {
      position: relative;
      height: 300px;
    }
    
    .highlight {
      color: #3498db;
      font-weight: bold;
    }
    
    .comparison-box {
      padding: 20px;
      background: #ecf0f1;
      border-radius: 8px;
      margin: 20px 0;
    }
    
    .print-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      padding: 15px 30px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
      z-index: 1000;
    }
    
    .print-button:hover {
      background: #2980b9;
    }
  </style>
</head>
<body>
  <button class="print-button no-print" onclick="window.print()">ğŸ“„ ì¸ì‡„í•˜ê¸°</button>
  
  <div class="report-container">
    <!-- ë³´ê³ ì„œ í—¤ë” -->
    <div class="report-header">
      <div class="report-title"><%= reportData.companyName %></div>
      <div class="report-subtitle"><%= year %>ë…„ ê²Œì„ë”í•˜ê¸° ì‚¬ì—… ì„±ê³¼ ë³´ê³ ì„œ</div>
    </div>

    <!-- 1. ê¸°ë³¸ ì •ë³´ & ê°œìš” -->
    <section class="section">
      <h2 class="section-title">1. ê¸°ë³¸ ì •ë³´</h2>
      
      <div class="info-grid">
        <div class="info-card">
          <div class="info-label">ë‹´ë‹¹ ë§¤ë‹ˆì €</div>
          <div class="info-value"><%= reportData.basicInfo.managers %></div>
        </div>
        
        <div class="info-card">
          <div class="info-label">ë³´ìœ  ê²Œì„ ìˆ˜</div>
          <div class="info-value"><%= reportData.basicInfo.gameCount %>ê°œ</div>
        </div>
        
        <div class="info-card">
          <div class="info-label">ìš°ìˆ˜ê²Œì„ì‚¬ ì„ ì •</div>
          <div class="info-value">
            <% if (reportData.basicInfo.isExcellent) { %>
              <span class="badge excellent"><%= reportData.basicInfo.excellentLevel %> ìš°ìˆ˜ê²Œì„ì‚¬</span>
            <% } else { %>
              ë¯¸ì„ ì •
            <% } %>
          </div>
        </div>
        
        <div class="info-card">
          <div class="info-label">ì¢…í•© ë“±ê¸‰</div>
          <div class="info-value">
            <span class="badge grade-<%= reportData.evaluation.grade.toLowerCase() %>">
              <%= reportData.evaluation.grade %> ë“±ê¸‰
            </span>
          </div>
        </div>
      </div>
      
      <h3 class="section-subtitle">ë³´ìœ  ê²Œì„ ëª©ë¡</h3>
      <table class="data-table">
        <thead>
          <tr>
            <th>ê²Œì„ëª…</th>
            <th>í”Œë«í¼</th>
          </tr>
        </thead>
        <tbody>
          <% reportData.basicInfo.games.forEach(game => { %>
          <tr>
            <td><%= game.name %></td>
            <td><%= game.platform %></td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </section>

    <!-- 2. í¬ì¸íŠ¸ ì§€ì› í˜„í™© -->
    <section class="section">
      <h2 class="section-title">2. í¬ì¸íŠ¸ ì§€ì› í˜„í™©</h2>
      
      <div class="overview-grid">
        <div class="overview-card blue">
          <div class="label">ì´ ë°°ì • í¬ì¸íŠ¸</div>
          <div class="value"><%= Math.round(reportData.pointInfo.totalPoints).toLocaleString() %></div>
          <div class="label">ì›</div>
        </div>
        
        <div class="overview-card green">
          <div class="label">ì‚¬ìš© í¬ì¸íŠ¸</div>
          <div class="value"><%= Math.round(reportData.pointInfo.usedPoints).toLocaleString() %></div>
          <div class="label">ì›</div>
        </div>
        
        <div class="overview-card orange">
          <div class="label">ì”ì—¬ í¬ì¸íŠ¸</div>
          <div class="value"><%= Math.round(reportData.pointInfo.remainingPoints).toLocaleString() %></div>
          <div class="label">ì›</div>
        </div>
        
        <div class="overview-card purple">
          <div class="label">ì‚¬ìš©ë¥ </div>
          <div class="value"><%= reportData.pointInfo.usageRate.toFixed(1) %></div>
          <div class="label">%</div>
        </div>
      </div>
      
      <h3 class="section-subtitle">í¬ì¸íŠ¸ ì„¸ë¶€ ë‚´ì—­</h3>
      <table class="data-table">
        <thead>
          <tr>
            <th>êµ¬ë¶„</th>
            <th class="text-right">í¬ì¸íŠ¸</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>ê¸°ë³¸ í¬ì¸íŠ¸</td>
            <td class="text-right"><%= Math.round(reportData.pointInfo.basePoints).toLocaleString() %>ì›</td>
          </tr>
          <tr>
            <td>ìë¶€ë‹´ í¬ì¸íŠ¸</td>
            <td class="text-right"><%= Math.round(reportData.pointInfo.selfPoints).toLocaleString() %>ì›</td>
          </tr>
          <% if (reportData.pointInfo.excellentPoints.first > 0) { %>
          <tr>
            <td>ìš°ìˆ˜ í¬ì¸íŠ¸ (1ì°¨)</td>
            <td class="text-right"><%= Math.round(reportData.pointInfo.excellentPoints.first).toLocaleString() %>ì›</td>
          </tr>
          <% } %>
          <% if (reportData.pointInfo.excellentPoints.second > 0) { %>
          <tr>
            <td>ìš°ìˆ˜ í¬ì¸íŠ¸ (2ì°¨)</td>
            <td class="text-right"><%= Math.round(reportData.pointInfo.excellentPoints.second).toLocaleString() %>ì›</td>
          </tr>
          <% } %>
          <% if (reportData.pointInfo.excellentPoints.third > 0) { %>
          <tr>
            <td>ìš°ìˆ˜ í¬ì¸íŠ¸ (3ì°¨)</td>
            <td class="text-right"><%= Math.round(reportData.pointInfo.excellentPoints.third).toLocaleString() %>ì›</td>
          </tr>
          <% } %>
          <tr style="background: #f8f9fa; font-weight: bold;">
            <td>í•©ê³„</td>
            <td class="text-right"><%= Math.round(reportData.pointInfo.totalPoints).toLocaleString() %>ì›</td>
          </tr>
        </tbody>
      </table>
    </section>

    <div class="page-break"></div>

    <!-- 3. ì„œë¹„ìŠ¤ ë¶€ë¬¸ë³„ í¬ì¸íŠ¸ ì‚¬ìš© -->
    <section class="section">
      <h2 class="section-title">3. ì„œë¹„ìŠ¤ ë¶€ë¬¸ë³„ í¬ì¸íŠ¸ ì‚¬ìš©</h2>
      
      <div class="chart-container">
        <div class="chart-wrapper">
          <canvas id="categoryChart"></canvas>
        </div>
      </div>
      
      <table class="data-table">
        <thead>
          <tr>
            <th rowspan="2" style="vertical-align: middle;">ì„œë¹„ìŠ¤ ë¶€ë¬¸</th>
            <th colspan="2" class="text-center" style="border-bottom: 1px solid #ecf0f1;">ê¸°ë³¸ í¬ì¸íŠ¸</th>
            <th colspan="2" class="text-center" style="border-bottom: 1px solid #ecf0f1;">ìš°ìˆ˜ í¬ì¸íŠ¸</th>
            <th rowspan="2" class="text-right" style="vertical-align: middle;">í•©ê³„</th>
          </tr>
          <tr>
            <th class="text-right">ê¸ˆì•¡</th>
            <th class="text-right">ë¹„ìœ¨</th>
            <th class="text-right">ê¸ˆì•¡</th>
            <th class="text-right">ë¹„ìœ¨</th>
          </tr>
        </thead>
        <tbody>
          <% 
          const totalBaseAmount = Object.values(reportData.categoryUsageDetailed).reduce((sum, d) => sum + d.base, 0);
          const totalExcellentAmount = Object.values(reportData.categoryUsageDetailed).reduce((sum, d) => sum + d.excellent, 0);
          const totalCategoryAmount = totalBaseAmount + totalExcellentAmount;
          
          Object.entries(reportData.categoryUsageDetailed).sort((a, b) => b[1].total - a[1].total).forEach(([category, detail]) => { 
          %>
          <tr>
            <td><%= category %></td>
            <td class="text-right"><%= Math.round(detail.base).toLocaleString() %>ì›</td>
            <td class="text-right">
              <%= totalBaseAmount > 0 ? (detail.base / totalBaseAmount * 100).toFixed(1) : 0 %>%
            </td>
            <td class="text-right"><%= Math.round(detail.excellent).toLocaleString() %>ì›</td>
            <td class="text-right">
              <%= totalExcellentAmount > 0 ? (detail.excellent / totalExcellentAmount * 100).toFixed(1) : 0 %>%
            </td>
            <td class="text-right"><strong><%= Math.round(detail.total).toLocaleString() %>ì›</strong></td>
          </tr>
          <% }); %>
          <tr style="background: #f8f9fa; font-weight: bold;">
            <td>ì´ê³„</td>
            <td class="text-right"><%= Math.round(totalBaseAmount).toLocaleString() %>ì›</td>
            <td class="text-right">100.0%</td>
            <td class="text-right"><%= Math.round(totalExcellentAmount).toLocaleString() %>ì›</td>
            <td class="text-right"><%= totalExcellentAmount > 0 ? '100.0%' : '-' %></td>
            <td class="text-right"><%= Math.round(totalCategoryAmount).toLocaleString() %>ì›</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- 4. ì„±ê³¼ ì§€í‘œ -->
    <section class="section">
      <h2 class="section-title">4. ì„±ê³¼ ì§€í‘œ (ê¸€ë¡œë²Œ)</h2>
      
      <div class="overview-grid">
        <div class="overview-card blue">
          <div class="label">ì´ ë§¤ì¶œ</div>
          <div class="value"><%= Math.round(reportData.performance.revenue).toLocaleString() %></div>
          <div class="label">ì›</div>
        </div>
        
        <div class="overview-card green">
          <div class="label">ì´ ë‹¤ìš´ë¡œë“œ</div>
          <div class="value"><%= reportData.performance.downloads.toLocaleString() %></div>
          <div class="label">íšŒ</div>
        </div>
        
        <% if (reportData.performance.isMobilePlatform) { %>
        <div class="overview-card orange">
          <div class="label">í‰ê·  DAU</div>
          <div class="value"><%= reportData.performance.dau.toLocaleString() %></div>
          <div class="label">ëª…</div>
        </div>
        <% } else if (reportData.performance.isNonMobilePlatform) { %>
        <div class="overview-card orange">
          <div class="label">ì´ ìœ„ì‹œë¦¬ìŠ¤íŠ¸</div>
          <div class="value"><%= reportData.performance.wishlist.toLocaleString() %></div>
          <div class="label">ê°œ</div>
        </div>
        <% } %>
        
        <div class="overview-card purple">
          <div class="label">ë§¤ì¶œ ë¹„ì¤‘</div>
          <div class="value"><%= reportData.performance.revenueShare.toFixed(1) %></div>
          <div class="label">%</div>
        </div>
      </div>
      
      <h3 class="section-subtitle">ì›”ë³„ ë§¤ì¶œ ì¶”ì´</h3>
      <div class="chart-container">
        <div class="chart-wrapper">
          <canvas id="monthlyChart"></canvas>
        </div>
      </div>
    </section>

    <div class="page-break"></div>

    <!-- 5. ê²Œì„ë³„ ìƒì„¸ ì„±ê³¼ -->
    <section class="section">
      <h2 class="section-title">5. ê²Œì„ë³„ ìƒì„¸ ì„±ê³¼</h2>
      
      <table class="data-table">
        <thead>
          <tr>
            <th>ìˆœìœ„</th>
            <th>ê²Œì„ëª…</th>
            <th>í”Œë«í¼</th>
            <th class="text-right">ê¸€ë¡œë²Œ ë§¤ì¶œ</th>
            <th class="text-right">ë‹¤ìš´ë¡œë“œ</th>
            <th class="text-right">
              <% if (reportData.performance.isMobilePlatform) { %>
                í‰ê·  DAU
              <% } else { %>
                ìœ„ì‹œë¦¬ìŠ¤íŠ¸
              <% } %>
            </th>
          </tr>
        </thead>
        <tbody>
          <% reportData.gamePerformances.forEach((game, index) => { %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= game.gameName %></td>
            <td><%= game.platform %></td>
            <td class="text-right"><%= Math.round(game.revenue).toLocaleString() %>ì›</td>
            <td class="text-right"><%= game.downloads.toLocaleString() %></td>
            <td class="text-right">
              <% if (game.platform === 'ëª¨ë°”ì¼') { %>
                <%= game.dau.toLocaleString() %>
              <% } else { %>
                <%= game.wishlist.toLocaleString() %>
              <% } %>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </section>

    <!-- 6. íˆ¬ì íš¨ìœ¨ì„± ë¶„ì„ -->
    <section class="section">
      <h2 class="section-title">6. íˆ¬ì íš¨ìœ¨ì„± ë¶„ì„</h2>
      
      <div class="comparison-box">
        <h3 style="margin-bottom: 20px;">ROI ë¶„ì„</h3>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
          <div>
            <div style="font-size: 14px; color: #7f8c8d;">ë³¸ ê²Œì„ì‚¬ ROI</div>
            <div style="font-size: 32px; font-weight: bold; color: #3498db;">
              <%= reportData.efficiency.roi.toFixed(2) %>ë°°
            </div>
          </div>
          <div>
            <div style="font-size: 14px; color: #7f8c8d;">ì „ì²´ í‰ê·  ROI</div>
            <div style="font-size: 32px; font-weight: bold; color: #95a5a6;">
              <%= reportData.efficiency.avgROI.toFixed(2) %>ë°°
            </div>
          </div>
          <div>
            <div style="font-size: 14px; color: #7f8c8d;">í‰ê·  ëŒ€ë¹„</div>
            <div style="font-size: 32px; font-weight: bold; color: <%= reportData.efficiency.vsAverage >= 0 ? '#27ae60' : '#e74c3c' %>">
              <%= reportData.efficiency.vsAverage >= 0 ? '+' : '' %><%= reportData.efficiency.vsAverage.toFixed(1) %>%
            </div>
          </div>
        </div>
      </div>
      
      <table class="data-table">
        <thead>
          <tr>
            <th>ì§€í‘œ</th>
            <th class="text-right">ê°’</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>íˆ¬ì… í¬ì¸íŠ¸</td>
            <td class="text-right"><%= Math.round(reportData.pointInfo.totalPoints).toLocaleString() %>ì›</td>
          </tr>
          <tr>
            <td>ë°œìƒ ë§¤ì¶œ</td>
            <td class="text-right"><%= Math.round(reportData.performance.revenue).toLocaleString() %>ì›</td>
          </tr>
          <tr>
            <td>ROI (Return on Investment)</td>
            <td class="text-right"><strong><%= reportData.efficiency.roi.toFixed(2) %>ë°°</strong></td>
          </tr>
          <tr>
            <td>1ì–µì›ë‹¹ ë‹¤ìš´ë¡œë“œ</td>
            <td class="text-right"><%= Math.round(reportData.efficiency.downloadsPerHundredMillion).toLocaleString() %>íšŒ</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- 7. ìˆœìœ„ & ë²¤ì¹˜ë§ˆí‚¹ -->
    <section class="section">
      <h2 class="section-title">7. ìˆœìœ„ & ë²¤ì¹˜ë§ˆí‚¹</h2>
      
      <div class="info-grid">
        <div class="info-card">
          <div class="info-label">ë§¤ì¶œ ìˆœìœ„</div>
          <div class="info-value">
            <%= reportData.ranking.revenue %>ìœ„ / <%= reportData.ranking.totalCompanies %>ê°œì‚¬
          </div>
        </div>
        
        <div class="info-card">
          <div class="info-label">ROI ìˆœìœ„</div>
          <div class="info-value">
            <%= reportData.ranking.roi %>ìœ„ / <%= reportData.ranking.totalCompanies %>ê°œì‚¬
          </div>
        </div>
      </div>
    </section>

    <div class="page-break"></div>

    <!-- 8. ê³„ì•½ í˜„í™© ìƒì„¸ -->
    <section class="section">
      <h2 class="section-title">8. ê³„ì•½ í˜„í™© ìƒì„¸</h2>
      
      <div class="overview-grid" style="grid-template-columns: repeat(3, 1fr);">
        <div class="overview-card blue">
          <div class="label">ì´ ê³„ì•½ ê±´ìˆ˜</div>
          <div class="value"><%= reportData.contracts.total %></div>
          <div class="label">ê±´</div>
        </div>
        
        <div class="overview-card green">
          <div class="label">í™•ì • ê³„ì•½</div>
          <div class="value"><%= reportData.contracts.confirmed %></div>
          <div class="label">ê±´</div>
        </div>
        
        <div class="overview-card orange">
          <div class="label">ê³„ì•½ ê¸ˆì•¡ í•©ê³„</div>
          <div class="value"><%= Math.round(reportData.contracts.totalAmount).toLocaleString() %></div>
          <div class="label">ì›</div>
        </div>
      </div>
      
      <h3 class="section-subtitle">í™•ì • ê³„ì•½ ë‚´ì—­</h3>
      <table class="data-table">
        <thead>
          <tr>
            <th>ê²Œì„ëª…</th>
            <th>ì„œë¹„ìŠ¤ ë¶€ë¬¸</th>
            <th>ë²¤ë”ì‚¬</th>
            <th class="text-right">ê³„ì•½ ê¸ˆì•¡</th>
            <th>ê³„ì•½ ìƒíƒœ</th>
          </tr>
        </thead>
        <tbody>
          <% reportData.contracts.details.forEach(contract => { %>
          <tr>
            <td><%= contract.game_name %></td>
            <td><%= contract.service_category %></td>
            <td><%= contract.selected_vendor %></td>
            <td class="text-right"><%= contract.contract_amount %></td>
            <td><%= contract.status %></td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </section>

    <!-- 9. ì¢…í•© í‰ê°€ -->
    <section class="section">
      <h2 class="section-title">9. ì¢…í•© í‰ê°€</h2>
      
      <div class="comparison-box">
        <h3>ì¢…í•© ë“±ê¸‰: <span class="badge grade-<%= reportData.evaluation.grade.toLowerCase() %>"><%= reportData.evaluation.grade %></span></h3>
        
        <div style="margin-top: 20px;">
          <p style="line-height: 1.8; color: #2c3e50;">
            <%= reportData.companyName %>ì€(ëŠ”) <%= year %>ë…„ ê²Œì„ë”í•˜ê¸° ì‚¬ì—…ì„ í†µí•´ 
            ì´ <span class="highlight"><%= Math.round(reportData.pointInfo.totalPoints).toLocaleString() %>ì›</span>ì˜ í¬ì¸íŠ¸ë¥¼ ì§€ì›ë°›ì•„
            <span class="highlight"><%= Math.round(reportData.performance.revenue).toLocaleString() %>ì›</span>ì˜ ê¸€ë¡œë²Œ ë§¤ì¶œì„ ë‹¬ì„±í•˜ì˜€ìœ¼ë©°,
            <span class="highlight"><%= reportData.efficiency.roi.toFixed(2) %>ë°°</span>ì˜ ROIë¥¼ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤.
          </p>
          
          <p style="line-height: 1.8; color: #2c3e50; margin-top: 15px;">
            ì „ì²´ <%= reportData.ranking.totalCompanies %>ê°œ ê²Œì„ì‚¬ ì¤‘ ë§¤ì¶œ ìˆœìœ„ <span class="highlight"><%= reportData.ranking.revenue %>ìœ„</span>,
            ROI ìˆœìœ„ <span class="highlight"><%= reportData.ranking.roi %>ìœ„</span>ë¥¼ ê¸°ë¡í•˜ì—¬
            <%= reportData.evaluation.grade === 'S' ? 'íƒì›”í•œ' : reportData.evaluation.grade === 'A' ? 'ìš°ìˆ˜í•œ' : reportData.evaluation.grade === 'B' ? 'ì–‘í˜¸í•œ' : 'ë³´í†µì˜' %> 
            ì„±ê³¼ë¥¼ ë³´ì˜€ìŠµë‹ˆë‹¤.
          </p>
        </div>
      </div>
    </section>

    <!-- ë³´ê³ ì„œ ë -->
    <div style="margin-top: 60px; padding-top: 30px; border-top: 2px solid #ecf0f1; text-align: center; color: #95a5a6;">
      <p>ë³¸ ë³´ê³ ì„œëŠ” <%= new Date().toLocaleDateString('ko-KR') %> ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
      <p>ê²Œì„ë”í•˜ê¸° ì‚¬ì—… | <%= year %>ë…„ ì„±ê³¼ ë³´ê³ ì„œ</p>
    </div>
  </div>

  <script>
    // ì„œë¹„ìŠ¤ ë¶€ë¬¸ë³„ ì°¨íŠ¸ (ê¸°ë³¸/ìš°ìˆ˜ êµ¬ë¶„)
    const categoryCtx = document.getElementById('categoryChart');
    if (categoryCtx) {
      const categoryDetailedData = <%- JSON.stringify(reportData.categoryUsageDetailed) %>;
      const categories = Object.keys(categoryDetailedData).sort((a, b) => 
        categoryDetailedData[b].total - categoryDetailedData[a].total
      );
      const baseAmounts = categories.map(c => categoryDetailedData[c].base);
      const excellentAmounts = categories.map(c => categoryDetailedData[c].excellent);
      
      new Chart(categoryCtx, {
        type: 'bar',
        data: {
          labels: categories,
          datasets: [
            {
              label: 'ê¸°ë³¸ í¬ì¸íŠ¸',
              data: baseAmounts,
              backgroundColor: '#3498db',
              stack: 'stack0'
            },
            {
              label: 'ìš°ìˆ˜ í¬ì¸íŠ¸',
              data: excellentAmounts,
              backgroundColor: '#f1c40f',
              stack: 'stack0'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'ì„œë¹„ìŠ¤ ë¶€ë¬¸ë³„ í¬ì¸íŠ¸ ì‚¬ìš© (ê¸°ë³¸/ìš°ìˆ˜ êµ¬ë¶„)'
            },
            legend: {
              display: true,
              position: 'top'
            }
          },
          scales: {
            x: {
              stacked: true
            },
            y: {
              stacked: true,
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return (value / 100000000).toFixed(1) + 'ì–µì›';
                }
              }
            }
          }
        }
      });
    }
    
    // ì›”ë³„ ë§¤ì¶œ ì¶”ì´ ì°¨íŠ¸
    const monthlyCtx = document.getElementById('monthlyChart');
    if (monthlyCtx) {
      const monthlyData = <%- JSON.stringify(reportData.monthlyData) %>;
      
      new Chart(monthlyCtx, {
        type: 'line',
        data: {
          labels: monthlyData.map(m => m.monthName),
          datasets: [{
            label: 'ê¸€ë¡œë²Œ ë§¤ì¶œ',
            data: monthlyData.map(m => m.revenue),
            borderColor: '#3498db',
            backgroundColor: 'rgba(52, 152, 219, 0.1)',
            tension: 0.4,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: 'ì›”ë³„ ê¸€ë¡œë²Œ ë§¤ì¶œ ì¶”ì´'
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return Math.round(value).toLocaleString() + 'ì›';
                }
              }
            }
          }
        }
      });
    }
  </script>
</body>
</html>

